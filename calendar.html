<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <!-- Bootstrap CSS -->
    <link href="./assets/css/bootstrap.css" rel="stylesheet">
    <!-- MDI Icons -->
    <link href="https://cdn.jsdelivr.net/npm/@mdi/font/css/materialdesignicons.min.css" rel="stylesheet">
    <!-- FullCalendar CSS -->
    <link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.0.0/main.min.css" rel="stylesheet">
    <link href='https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css' rel='stylesheet'>
    <!-- Tabulator -->
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/tabulator/6.2.5/css/tabulator_bootstrap5.min.css"
        integrity="sha512-qDEgvDbdp7tq+ytU/OgCzWfvbfdEe3pv0yEOMz/gurMcR0BWNgIF6I4VKeoACEj5E5PFf1uo3Vzuwk/ga9zeUg=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <!-- SweetAlert2 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css" rel="stylesheet">
    <!-- Virtual Select -->
    <link rel="stylesheet" href="./assets/css/virtual-select.css">
    <link rel="stylesheet" href="./assets/css/componets.css">
</head>

<body>

    <div class="wrapper">
        <!-- Sidebar -->
        <div class="sidebar bg-primary">
            <div class="text-center py-1">
                <!-- Logo -->
                <a href="index.html"><i class="mdi mdi-hexagon-outline mdi-36px text-light"></i></a>
            </div>
            <ul class="sidebar-nav mt-1">
                <li class="sidebar-item">
                    <a href="#" class="sidebar-link">
                        <i class="mdi mdi-gauge"></i>
                        <span>Indicadores</span>
                    </a>
                </li>
                <li class="sidebar-item">
                    <a href="#" class="sidebar-link">
                        <i class="mdi mdi-earth"></i>
                        <span>Geodatos</span>
                    </a>
                </li>
                <li class="sidebar-item">
                    <a href="#" class="sidebar-link">
                        <i class="mdi mdi-chart-pie"></i>
                        <span>Simulación</span>
                    </a>
                </li>
                <li class="sidebar-item">
                    <a href="calendar.html" class="sidebar-link active">
                        <i class="mdi mdi-calendar-check"></i>
                        <span>Planeador</span>
                    </a>
                </li>
                <li class="sidebar-item">
                    <a href="./profile.html" class="sidebar-link">
                        <i class="mdi mdi-account-circle"></i>
                        <span>Mi Cuenta</span>
                    </a>
                </li>
                <li class="sidebar-item">
                    <a href="RegisterUsers.html" class="sidebar-link">
                        <i class="mdi mdi-account-group"></i>
                        <span>Usuarios</span>
                    </a>
                </li>
                <li class="sidebar-item">
                    <a href="#" class="sidebar-link">
                        <i class="mdi mdi-cog-outline"></i>
                        <span>Configuraciones</span>
                    </a>
                </li>
            </ul>
        </div>

        <!-- Main content -->
        <div class="main">
            <!-- Navbar -->
            <nav class="navbar navbar-expand-lg navbar-light bg-light shadow p-0">
                <div class="container-fluid">
                    <!-- Sidebar Toggle Button -->
                    <div class="toggle-btn" type="button">
                        <i class="mdi mdi-menu"></i>
                    </div>
                    <div class="collapse navbar-collapse justify-content-end">
                        <!-- Dropdown de Administrador -->
                        <div class="dropdown">
                            <a class="btn dropdown-toggle d-flex align-items-center" href="#" role="button"
                                id="dropdownMenuLink" data-bs-toggle="dropdown" aria-expanded="false">
                                <span class="me-2">Administrador</span>
                                <i class="mdi mdi-account-circle mdi-36px"></i>
                            </a>

                            <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdownMenuLink">
                                <li><a class="dropdown-item" href="#">Cerrar Sesión</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </nav>

            <div class="container-fluid p-5">
                <!-- Menú de opciones de planner -->
                <div class="row p-3 gradient-dark">
                    <div class="col-4">
                        <h2 class="text-light">Planeador</h2>
                    </div>
                    <div class="col-8">
                        <div class="d-flex justify-content-end">
                            <a href="./summary.html" class="btn btn-info me-2">Análisis de actividades</a>
                            <a href="./createActivity.html" class="btn btn-outline-info">Crear Actvidad</a>
                        </div>
                    </div>
                </div>

                <div class="row mt-3">
                    <div class="col-2 p-0 pe-3" id="sectionFilter">
                        <div class="card shadow">
                            <div class="card-body">
                                <!-- Grupo de botones -->
                                <div class="btn-group w-100 mb-3" role="group">
                                    <button type="button" id="btn-kanvas"
                                        class="btn btn-outline-primary flex-grow-1">Kanvas</button>
                                    <button type="button" id="btn-calendar"
                                        class="btn btn-outline-primary flex-grow-1">Calendario</button>
                                </div>

                                <!-- Filtros -->
                                <label for="" class="form-label">Filtrar por tipo de actividad</label>
                                <div id="activityFilter" class="mb-3"></div>

                                <label for="" class="form-label">Filtrar por región</label>
                                <div id="regionFilter" class="mb-3"></div>

                                <!-- Filtro por código de actividad -->
                                <label for="activityCodeFilter" class="form-label">Filtrar por código de
                                    actividad</label>
                                <div id="activityCodeFilter" class="mb-3"></div>

                                <!-- Filtro por fecha -->
                                <label for="startDateFilter" class="form-label">Filtrar por fecha de inicio</label>
                                <input type="date" id="startDateFilter" class="form-control mb-3">

                                <label for="endDateFilter" class="form-label">Filtrar por fecha de fin</label>
                                <input type="date" id="endDateFilter" class="form-control mb-3">

                                <!-- Botón para buscar y limpiar filtros -->
                                <div class="d-grid mb-3">
                                    <div class="btn-group w-100" role="group">
                                        <button id="applyFilters" class="btn btn-outline-secondary">Buscar</button>
                                        <button id="clearFilters" class="btn btn-outline-secondary">Limpiar</button>
                                    </div>
                                </div>

                                <!-- Botón para movilizar con icono y tooltip -->
                                <div class="d-grid">
                                    <button id="modifyButton" class="btn btn-outline-secondary d-none"
                                        data-bs-toggle="tooltip" data-bs-placement="top" title="Movilizar Actividades">
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-10 p-0">
                        <div class="card shadow">
                            <div class="card-body">
                                <!-- Kanvas de actividades por estado de actividad -->
                                <div class="row" id="kanvas">
                                    <div class="col-2">
                                        <h5 class="bg-success p-3 text-light">Programada</h5>
                                        <div id="scheduled" class="list-group"></div>
                                    </div>
                                    <div class="col-2">
                                        <h5 class="bg-info text-dark p-3">En ejecución</h5>
                                        <div id="inProgress" class="list-group"></div>
                                    </div>
                                    <div class="col-2">
                                        <h5 class="bg-danger p-3 text-light">Vencida</h5>
                                        <div id="defeated" class="list-group"></div>
                                    </div>
                                    <div class="col-2">
                                        <h5 class="bg-ultra-purple text-light p-3">Vencida en ejecución</h5>
                                        <div id="overdueExecution" class="list-group"></div>
                                    </div>
                                    <div class="col-2">
                                        <h5 class="bg-primary text-light p-3">Finalizada</h5>
                                        <div id="completed" class="list-group"></div>
                                    </div>
                                    <div class="col-2">
                                        <h5 class="bg-electric-purple text-light p-3">Finalizada vencida</h5>
                                        <div id="completedExpired" class="list-group"></div>
                                    </div>
                                </div>

                                <!-- Calendario -->
                                <div id="calendar" class="d-none mt-4"></div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Popup de la actividad -->
    <div id="eventPopup" class="card shadow popup-evento d-none p-0 border-0 rounded-3">
        <div class="card-header gradient-dark text-white d-flex justify-content-between align-items-center">
            <!-- Botón para eliminar la actividad -->
            <button id="deleteActivityBtn" class="btn btn-link text-light p-0 me-3">
                <i class="mdi mdi-delete-outline mdi-18px"></i>
            </button>
            <h5 id="popupTitle" class="mb-0"></h5>
            <button type="button" class="btn-close btn-close-white close-icon" aria-label="Close"></button>
        </div>
        <div class="card-body p-4">
            <div class="row d-flex align-content-center">
                <div class="col mb-3">
                    <p><i class="mdi mdi-text-long mdi-18px me-2"></i><strong
                            class="fw-bold text-primary fs-4">Descripción:</strong> <span id="popupDescription"></span>
                    </p>
                    <p><i class="mdi mdi-calendar-clock mdi-18px me-2"></i><strong
                            class="fw-bold text-primary fs-4">Fecha:</strong> <span id="popupDates"></span></p>
                    <p><i class="mdi mdi-map mdi-18px me-2"></i><strong
                            class="fw-bold text-primary fs-4">Región:</strong> <span id="popupRegion"></span>
                    </p>
                </div>
                <div class="col mb-1">
                    <p><i class="mdi mdi-account-check mdi-18px me-2"></i><strong
                            class="fw-bold text-primary fs-4">Estado:</strong> <span id="popupStatus"></span>
                    </p>
                    <p><i class="mdi mdi-priority-high mdi-18px me-2"></i><strong
                            class="fw-bold text-primary fs-4">Prioridad:</strong> <span id="popupPriority"></span></p>
                    <p><i class="mdi mdi-comment-text-multiple-outline mdi-18px me-2"></i><strong
                            class="fw-bold text-primary fs-4">Comentarios:</strong> <span id="popupComments"></span></p>
                </div>
            </div>
            <div class="my-1 d-flex justify-content-end">
                <div class="text-center">
                    <img id="popupImage" src="" alt="Imagen del usuario" class="img-fluid rounded-circle shadow">
                    <p id="popupUserName" class="mt-2 mb-0 fw-bold"></p>
                </div>
            </div>
        </div>
        <div class="card-footer d-flex justify-content-between align-items-center py-3 px-4 border-0">
            <button class="btn btn-outline-secondary" data-bs-toggle="modal"
                data-bs-target="#update">Actualizar</button>
            <div>
                <button id="viewNoteBtn" class="btn btn-warning me-2" data-bs-toggle="modal"
                    data-bs-target="#noteModal">Última Actualización</button>
                <a id="pdfLink" class="btn btn-outline-primary me-2" href="#" target="_blank">Ver PDF</a>
            </div>
        </div>
    </div>

    <!-- Modal para la nota -->
    <div class="modal fade" id="noteModal" tabindex="-1" aria-labelledby="noteModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-body">
                    <p><strong>Última actualización:</strong> <span id="lastUpdateDate"></span></p>
                    <p><strong>Proceso que se realizo:</strong> <span id="lastUpdateNote"></span></p>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para mostrar detalles de la tarea con formulario -->
    <div class="modal fade" id="update" tabindex="-1" aria-labelledby="taskModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="taskModalLabel">Detalles de la tarea</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="taskForm">
                        <div class="row">
                            <div class="col-7">
                                <div class="row mb-3">
                                    <div class="col-md-4">
                                        <label for="typeActivity" class="form-label"><strong>Tipo de
                                                actividad</strong></label>
                                        <select id="typeActivity" class="form-select">
                                            <option>Mantenimiento</option>
                                            <option>Expansión y Reposición</option>
                                            <option>Mantenimiento Equipos</option>
                                            <option>Podas</option>
                                        </select>
                                    </div>
                                    <div class="col-md-4">
                                        <label for="progress" class="form-label"><strong>Progreso</strong></label>
                                        <select id="progress" class="form-select">
                                            <option>Programada</option>
                                            <option>En ejecución</option>
                                            <option>Vencida</option>
                                            <option>Vencida en ejecución</option>
                                            <option>Finalizada</option>
                                            <option>Finalizada vencida</option>
                                        </select>
                                    </div>
                                    <div class="col-md-4">
                                        <label for="priority" class="form-label"><strong>Prioridad</strong></label>
                                        <select id="priority" class="form-select">
                                            <option selected>Media</option>
                                            <option>Alta</option>
                                            <option>Baja</option>
                                        </select>
                                    </div>
                                </div>

                                <div class="row mb-3">
                                    <div class="col-md-6">
                                        <label for="startDateModal" class="form-label"><strong>Fecha de
                                                inicio</strong></label>
                                        <input type="date" class="form-control" id="startDateModal">
                                    </div>
                                    <div class="col-md-6">
                                        <label for="endDateModal" class="form-label"><strong>Fecha de
                                                vencimiento</strong></label>
                                        <input type="date" class="form-control" id="endDateModal">
                                    </div>
                                </div>

                                <div class="mb-3">
                                    <label for="description" class="form-label"><strong>Descripción</strong></label>
                                    <textarea class="form-control" id="description" rows="3"></textarea>
                                </div>

                                <div class="mb-3">
                                    <label for="attachments" class="form-label"><strong>Datos
                                            adjuntos</strong></label>
                                    <button type="button" class="btn btn-outline-secondary" id="attachments">Agregar
                                        datos adjuntos</button>
                                </div>

                                <div class="mb-3">
                                    <label for="comments" class="form-label"><strong>Comentarios</strong></label>
                                    <textarea class="form-control" id="comments" rows="2"
                                        placeholder="Escribe aquí tu mensaje"></textarea>
                                </div>

                                <!-- Solicitud de cambio de fecha -->
                                <div class="mb-3">
                                    <label for="requestChange" class="form-label"><strong>Solicitud para cambiar
                                            la fecha</strong></label>
                                    <div class="row">
                                        <div class="col-md-6">
                                            <input type="date" class="form-control" id="newStartDate"
                                                placeholder="Nueva fecha de inicio">
                                        </div>
                                        <div class="col-md-6">
                                            <input type="date" class="form-control" id="newEndDate"
                                                placeholder="Nueva fecha de vencimiento">
                                        </div>
                                    </div>
                                    <button type="button" class="btn btn-outline-secondary mt-3"
                                        id="submitDateChange">Enviar
                                        solicitud</button>
                                </div>

                                <!-- Sección adicional que solo se muestra si el progreso es 'Finalizada' -->
                                <div id="finalizadaSection" class="d-none">
                                    <div class="mb-3">
                                        <label for="lacManeuvers" class="form-label"><strong>Maniobras
                                                LAC</strong></label>
                                        <input type="text" class="form-control" id="lacManeuvers"
                                            placeholder="Código de maniobra LAC">
                                    </div>

                                    <div class="row">
                                        <div class="col">
                                            <label class="form-label"><strong>OT</strong></label>
                                            <div id="otTable"></div>
                                        </div>
                                        <div class="col">
                                            <label class="form-label"><strong>Cosignaciones</strong></label>
                                            <div id="cosignationTable"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-5">
                                <div id="mapContainer" class="mb-3">
                                    <label for="map" class="form-label"><strong>Mapa de la
                                            ubicación</strong></label>
                                    <div class="map-wrapper">
                                        <img id="mapImage" src="./assets/img/mapa-prueba.png"
                                            class="img-fluid rounded shadow" alt="Mapa de la tarea">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" id="viewHistory">Ver
                                histórico</button>
                            <button type="submit" class="btn btn-primary" id="saveChanges">Guardar
                                cambios</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para mostrar el histórico de cambios -->
    <div class="modal fade" id="historyModal" tabindex="-1" aria-labelledby="historyModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="historyModalLabel">Histórico de cambios</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div id="changeHistoryTable"></div>
                    <!-- Tabla para el historial de cambios con Tabulator -->
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Tabulator -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tabulator/6.2.5/js/tabulator.min.js"
        integrity="sha512-orG5sHJgUiyGjeUBBK56+piLmrCEP7r5Tz9efhJ/C7F1Hdi8O33gQxqZThRb/PSAg9T5seRewR2pw5lTaZPTMQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.15.0/Sortable.min.js"></script>
    <!-- FullCalendar JS -->
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.15/index.global.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@fullcalendar/core@6.1.15/locales-all.global.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@fullcalendar/bootstrap5@6.1.15/index.global.min.js"></script>
    <!-- Virtual Select -->
    <script src="https://cdn.jsdelivr.net/npm/virtual-select-plugin@1.0.45/dist/virtual-select.min.js"></script>
    <!-- SweetAlert2 JS -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <!-- Jquery -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.js"
        integrity="sha512-+k1pnlgt4F1H8L7t3z95o3/KO+o78INEcXTbnoJQ/F2VqDVhWoaiVml/OEHv9HsVgxUaVW+IbiZPUJQfF/YxZw=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="./assets/js/calendar.js"></script>
    <script src="./assets/js/menu.js"></script>

</body>

</html>